(function(){'use strict';const componentCache=new Map();const pendingLoads=new Map();function loadComponent(componentName){if(componentCache.has(componentName)){return Promise.resolve(componentCache.get(componentName));}
if(pendingLoads.has(componentName)){return pendingLoads.get(componentName);}
const scriptSrc=`components/${componentName}.min.js`;const fallbackSrc=`components/${componentName}.js`;const existingScript=document.querySelector(`script[src="${scriptSrc}"], script[src="${fallbackSrc}"]`);if(existingScript){const loadPromise=new Promise((resolve,reject)=>{const checkLoaded=()=>{if(componentCache.has(componentName)){resolve(componentCache.get(componentName));}else{setTimeout(checkLoaded,50);}};checkLoaded();});pendingLoads.set(componentName,loadPromise);return loadPromise;}
const loadPromise=new Promise((resolve,reject)=>{const script=document.createElement('script');script.src=scriptSrc;script.onload=()=>{componentCache.set(componentName,true);pendingLoads.delete(componentName);resolve();};script.onerror=()=>{const fallbackScript=document.createElement('script');fallbackScript.src=fallbackSrc;fallbackScript.onload=()=>{componentCache.set(componentName,true);pendingLoads.delete(componentName);resolve();};fallbackScript.onerror=()=>{console.warn(`Failed to load component: ${componentName}`);pendingLoads.delete(componentName);reject(new Error(`Failed to load component: ${componentName}`));};document.head.appendChild(fallbackScript);};document.head.appendChild(script);});pendingLoads.set(componentName,loadPromise);return loadPromise;}
function findComponents(element=document){const components=new Set();const customElements=element.querySelectorAll('*');customElements.forEach(el=>{const tagName=el.tagName.toLowerCase();if(tagName.includes('-')&&!componentCache.has(tagName)&&!pendingLoads.has(tagName)){components.add(tagName);}});return Array.from(components);}
function initializeComponents(){const components=findComponents();const criticalComponents=['b-skip-link','b-hamburger','b-date','b-breadcrumbs','b-flavor-selector'];const critical=components.filter(comp=>criticalComponents.includes(comp));const nonCritical=components.filter(comp=>!criticalComponents.includes(comp));const criticalPromises=critical.map(comp=>loadComponent(comp).catch(()=>{}));const loadNonCritical=()=>{const nonCriticalPromises=nonCritical.map(comp=>loadComponent(comp).catch(()=>{}));return Promise.all(nonCriticalPromises);};if(window.requestIdleCallback){requestIdleCallback(()=>{loadNonCritical().catch(()=>{});},{timeout:2000});}else{setTimeout(loadNonCritical,100);}
return Promise.all(criticalPromises);}
if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',initializeComponents);}else{initializeComponents();}
let observerTimeout=null;const pendingComponents=new Set();function processPendingComponents(){if(pendingComponents.size===0)return;const components=Array.from(pendingComponents);pendingComponents.clear();components.forEach(comp=>loadComponent(comp).catch(()=>{}));}
const observer=new MutationObserver(mutations=>{mutations.forEach(mutation=>{mutation.addedNodes.forEach(node=>{if(node.nodeType===1){const components=findComponents(node);components.forEach(comp=>pendingComponents.add(comp));}});});if(observerTimeout){clearTimeout(observerTimeout);}
observerTimeout=setTimeout(()=>{if(window.requestIdleCallback){requestIdleCallback(processPendingComponents,{timeout:500});}else{processPendingComponents();}},100);});observer.observe(document.body,{childList:true,subtree:true});window.ComponentLoader={load:loadComponent,find:findComponents};(function(){'use strict';function initScrollDelegation(){const mainContent=document.getElementById('main-content');if(!mainContent){setTimeout(initScrollDelegation,100);return;}
const scrollableSelectors=['#main-menu','#situational-menu','.card-list','.link-list','.timeline-container','b-projects','b-skillsets'];function isInsideScrollableElement(element){if(!element)return false;for(const selector of scrollableSelectors){const closest=element.closest?element.closest(selector):null;if(closest){const canScroll=closest.scrollHeight>closest.clientHeight;if(canScroll){return true;}}}
return false;}
function isInsideMainContent(element){if(!element)return false;return element===mainContent||(element.closest&&element.closest('#main-content'));}
document.addEventListener('wheel',function(e){const target=e.target;if(isInsideScrollableElement(target)){return;}
if(isInsideMainContent(target)){return;}
if(mainContent.scrollHeight>mainContent.clientHeight){e.preventDefault();const deltaY=e.deltaY;const currentScroll=mainContent.scrollTop;const maxScroll=mainContent.scrollHeight-mainContent.clientHeight;let newScroll=currentScroll+deltaY;newScroll=Math.max(0,Math.min(newScroll,maxScroll));mainContent.scrollTop=newScroll;}},{passive:false});}
function setupScrollDelegation(){if(window.requestIdleCallback){requestIdleCallback(initScrollDelegation,{timeout:2000});}else{setTimeout(initScrollDelegation,500);}}
if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',setupScrollDelegation);}else{setupScrollDelegation();}})();(function(){function pauseVideosIfReducedMotion(){const prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(prefersReducedMotion){const videos=document.querySelectorAll('#backgrounds video, #foregrounds video');videos.forEach(video=>{video.pause();});}}
function setupReducedMotion(){pauseVideosIfReducedMotion();const reducedMotionQuery=window.matchMedia("(prefers-reduced-motion: reduce)");reducedMotionQuery.addEventListener('change',pauseVideosIfReducedMotion);}
if(window.requestIdleCallback){requestIdleCallback(setupReducedMotion,{timeout:2000});}else{setTimeout(setupReducedMotion,500);}})();})();